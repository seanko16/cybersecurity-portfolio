üß© TryHackMe ‚Äî File & Hash Threat Intelligence
üìö What I Learned
During this room, I explored indicators of suspicious files and learned how to identify and investigate potential threats. Key topics included heuristic filename indicators and file hash analysis.

Heuristic Filename Indicators
Double Extensions ‚Üí invoice.pdf.exe
Why it's a problem: By default, Windows hides known file extensions. This can trick users into thinking a malicious file is safe.
Prevention: Disable the option to hide file extensions in File Explorer.

System Binary Impersonation ‚Üí svchost.exe
Why it's a problem: Attackers may create files that appear to be legitimate system processes, while they are actually malicious.
Prevention: Don't rely solely on filenames. Instead, check file paths and create an allowlist of legitimate paths for specific filenames using Windows Defender Application Control (WDAC).

High-Entropy Strings ‚Üí jnkaf77t1.exe
Why it's a problem: These randomly generated filenames are often used by attackers to evade antivirus detection.
Prevention: Be cautious of suspicious filenames and provide employees with regular phishing awareness training to recognize potentially dangerous files.

Masquerading ‚Üí backup-2300.exe
Why it's a problem: Users may assume files with benign-looking names are safe.
Prevention:
Look for filenames executed from unusual locations, such as TEMP folders.
Check the parent process of newly created files.
Include this knowledge in employee phishing awareness training.

File Hashing
I learned how to compute file hashes across multiple platforms:

PowerShell:
Get-FileHash -LiteralPath "<file_path\filename.ext>" -Algorithm SHA256

CMD:
certutil -hashfile "<filename.ext>" SHA256

Linux:
sha256sum "<file_path/filename.ext>"

Best Practices:
Store hashes in lowercase to avoid discrepancies.
Hash what matters for your investigation. For example, if malware is inside a ZIP file, hash both the archive and the extracted binary.

Threat Intelligence Tools
MalwareBazaar: A platform similar to VirusTotal, with a complex syntax and a dashboard for analyzing malware samples.
Correlating multiple sources: I learned the importance of using multiple threat intelligence sources rather than relying on one.
VirusTotal & MITRE Techniques: VirusTotal can correlate known malware with MITRE ATT&CK techniques, which is useful for writing more detailed and actionable reports.

üõ†Ô∏è Skills Practiced
Identifying heuristic indicators of suspicious files
Calculating SHA256 hashes on PowerShell, CMD, and Linux
Threat intelligence correlation across multiple platforms
Security awareness considerations for employees

‚úîÔ∏è Takeaways
File path, filename, and execution location are critical when assessing file legitimacy.
Combining multiple sources of threat intelligence provides a more complete picture.
Employee training on phishing and suspicious file recognition is essential for organizational security.
